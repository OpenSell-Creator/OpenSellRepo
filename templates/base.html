{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="csrf-token" content="{{ csrf_token }}">
    <title>{% block title%}{% endblock%}Iwo Market Place</title>
  
    <!-- CSS Dependencies -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel='stylesheet' href='https://cdn-uicons.flaticon.com/2.5.1/uicons-solid-rounded/css/uicons-solid-rounded.css'>
    <link rel="stylesheet" href="{% static 'css/styles.css'%}">

    <style>
      :root {
        /* Light Theme - Navy Primary with Charcoal Secondary */
        --light-primary-color: #003366;     /* Navy Blue - dominant */
        --light-secondary-color: #004d99;   /* Lighter Navy */
        --light-accent-color: #ff6600;      /* Vibrant Orange accent */
        --light-background: #f5f5f5;        /* Off-white */
        --light-card-background: #ffffff;    /* Pure white */
        --light-text-primary: #003366;      /* Navy text */
        --light-text-secondary: #666666;    /* Light Gray text */
        --light-border-color: #cccccc;      /* Light Gray border */
        --light-hover-bg: #e6e6e6;          /* Light Gray hover */
        --light-success: #28a745;           /* Keep standard success */
        --light-warning: #ff6600;           /* Orange warning */
        --light-error: #dc3545;             /* Keep standard error */
        --light-info: #004d99;              /* Lighter Navy info */
        --light-muted: #8c8c8c;             /* Muted Gray */
        --light-shadow: rgba(0, 51, 102, 0.15);
        
        /* Dark Theme - Charcoal Primary with Navy Accents */
        --dark-primary-color: #36454f;      /* Charcoal - dominant */
        --dark-secondary-color: #001f3f;    /* Deep Navy */
        --dark-accent-color: #ff6600;       /* Gold accent */
        --dark-background: #1f2937;         /* Dark Charcoal background */
        --dark-card-background: #2a363e;    /* Lighter Charcoal surface */
        --dark-text-primary: #fffff0;       /* Ivory text */
        --dark-text-secondary: #d4d4c7;     /* Light Ivory text */
        --dark-border-color: #4a5a6a;       /* Medium Charcoal border */
        --dark-hover-bg: #2d3a47;           /* Mid Charcoal hover */
        --dark-success: #36454f;            /* Charcoal success */
        --dark-warning: #ff6600;            /* Gold warning */
        --dark-error: #dc3545;              /* Keep standard error */
        --dark-info: #001f3f;               /* Deep Navy info */
        --dark-muted: #708090;              /* Slate Gray */
        --dark-shadow: rgba(0, 0, 0, 0.3);
        
        /* Keep existing Typography variables */
        --font-primary: 'Poppins', sans-serif;
        --font-secondary: 'Newsreader', serif;
        --font-size-xs: 0.7rem;
        --font-size-sm: 0.8rem;
        --font-size-base: 0.95rem;
        --font-size-lg: 1.05rem;
        --font-size-xl: 1.15rem;
        --font-size-2xl: 1.35rem;
        --font-size-3xl: 1.65rem;
    
        /* Keep existing Spacing and Border Radius variables */
        --spacing-xs: 0.15rem;
        --spacing-sm: 0.35rem;
        --spacing-md: 0.75rem;
        --spacing-lg: 1.25rem;
        --spacing-xl: 1.75rem;
        --spacing-2xl: 2.5rem;
        
        --radius-sm: 0.25rem;
        --radius-md: 0.5rem;
        --radius-lg: 1rem;
        --radius-xl: 1.5rem;
        --radius-full: 9999px;
    }
      
      /* Theme Application */
      [data-bs-theme="light"] {
          --primary-color: var(--light-primary-color);
          --secondary-color: var(--light-secondary-color);
          --accent-color: var(--light-accent-color);
          --background-color: var(--light-background);
          --card-background: var(--light-card-background);
          --text-primary: var(--light-text-primary);
          --text-secondary: var(--light-text-secondary);
          --border-color: var(--light-border-color);
          --hover-bg: var(--light-hover-bg);
          --shadow-color: var(--light-shadow);
      }
      
      [data-bs-theme="dark"] {
          --primary-color: var(--dark-primary-color);
          --secondary-color: var(--dark-secondary-color);
          --accent-color: var(--dark-accent-color);
          --background-color: var(--dark-background);
          --card-background: var(--dark-card-background);
          --text-primary: var(--dark-text-primary);
          --text-secondary: var(--dark-text-secondary);
          --border-color: var(--dark-border-color);
          --hover-bg: var(--dark-hover-bg);
          --shadow-color: var(--dark-shadow);
      }
      
      /* Enhanced Base Styles */
      body {
          font-family: var(--font-primary);
          background-color: var(--background-color);
          color: var(--text-primary);
          line-height: 1.6;
          transition: background-color 0.3s ease, color 0.3s ease;
      }
      
      /* Content Wrapper with Advanced Layout */
      .content-wrapper {
          max-width: 1400px;
          margin: 0 auto;
          padding: var(--spacing-lg);
          grid-template-columns: repeat(12, 1fr);
          gap: var(--spacing-md);
      }
  
      .container {
          padding-left: var(--spacing-sm);
          padding-right: var(--spacing-sm);
      }
  
      .row {
          margin-left: calc(-1 * var(--spacing-sm));
          margin-right: calc(-1 * var(--spacing-sm));
      }
      
      .col, [class*="col-"] {
          padding-left: var(--spacing-sm);
          padding-right: var(--spacing-sm);
      }
  
      .card {
          background-color: var(--card-background);
          border: 1px solid var(--border-color);
          border-radius: var(--radius-lg);
          box-shadow: 0 4px 20px var(--shadow-color);
          transition: transform 0.3s ease, box-shadow 0.3s ease;
          overflow: hidden;
          margin-bottom: var(--spacing-md);
      }
  
      .card-title {
          font-size: var(--font-size-lg);
          margin-bottom: var(--spacing-sm);
      }
      
      .card:hover {
          transform: translateY(-5px);
          box-shadow: 0 8px 30px var(--shadow-color);
      }
      
      
      /* Base Button Styles */
      .btn {
          display: inline-flex;
          align-items: center;
          justify-content: center;
          height: 40px; /* Standard height */
          padding: 0 16px; /* Standard padding */
          font-size: var(--font-size-base); /* Standard font size */
          font-weight: 500; /* Standard font weight */
          border-radius: var(--radius-md); /* Standard border radius */
          border: 2px solid transparent; /* Standard border */
          transition: all 0.3s ease; /* Smooth transitions */
          white-space: nowrap; /* Prevent text wrapping */
          text-align: center;
          cursor: pointer;
      }

      /* Primary Button */
      .btn-primary {
          background-color: var(--primary-color);
          color: var(--card-background);
          border-color: var(--primary-color);
      }

      .btn-primary:hover {
          background-color: var(--secondary-color);
          border-color: var(--secondary-color);
          transform: translateY(-1px);
      }

      /* Secondary Button */
      .btn-secondary {
          background-color: var(--secondary-color);
          color: var(--card-background);
          border-color: var(--secondary-color);
      }

      .btn-secondary:hover {
          background-color: var(--primary-color);
          border-color: var(--primary-color);
          transform: translateY(-1px);
      }

      /* Outline Button */
      .btn-outline {
          background-color: transparent;
          color: var(--primary-color);
          border-color: var(--primary-color);
      }

      .btn-outline:hover {
          background-color: var(--primary-color);
          color: var(--card-background);
          border-color: var(--primary-color);
          transform: translateY(-1px);
      }

      /* Danger Button */
      .btn-danger {
          background-color: var(--light-error);
          color: var(--card-background);
          border-color: var(--light-error);
      }

      .btn-danger:hover {
          background-color: var(--dark-error);
          border-color: var(--dark-error);
          transform: translateY(-1px);
      }


      /* Success Button */
      .btn-success {
          background-color: var(--light-success);
          color: var(--card-background);
          border-color: var(--light-success);
      }

      .btn-success:hover {
          background-color: var(--dark-success);
          border-color: var(--dark-success);
          transform: translateY(-1px);
      }

      /* Warning Button */
      .btn-warning {
          background-color: var(--light-warning);
          color: var(--card-background);
          border-color: var(--light-warning);
      }

      .btn-warning:hover {
          background-color: var(--dark-warning);
          border-color: var(--dark-warning);
          transform: translateY(-1px);
      }

      /* Icon Buttons */
      .btn-icon {
          width: 40px; /* Square buttons for icons */
          padding: 0;
      }

      .btn-icon i {
          font-size: var(--font-size-lg);
      }

      /* Small Buttons */
      .btn-sm {
          height: 32px; /* Slightly smaller height */
          padding: 0 12px; /* Slightly smaller padding */
          font-size: var(--font-size-sm); /* Smaller font size */
      }

      /* Large Buttons */
      .btn-lg {
          height: 48px; /* Larger height */
          padding: 0 24px; /* Larger padding */
          font-size: var(--font-size-lg); /* Larger font size */
      }

      /* Disabled Buttons */
      .btn:disabled {
          opacity: 0.6;
          cursor: not-allowed;
          pointer-events: none;
      }

      .btn-accent {
        background-color: var(--light-accent-color);
        color: var(--light-primary-color);
        border: none;
    }
    
    .btn-accent:hover {
        background-color: #e6c200;  /* Slightly darker gold */
        color: var(--light-primary-color);
    }
    
    /* Custom Card Styles */
    .card-highlight {
        border-left: 4px solid var(--light-accent-color);
    }
    
    /* Custom Navigation Styles */
    .nav-link.active {
        color: var(--light-accent-color) !important;
        border-bottom: 2px solid var(--light-accent-color);
    }
      
      /* Advanced Form Controls */
      .form-control, .form-select {
          background-color: var(--card-background);
          border: 2px solid var(--border-color);
          color: var(--text-primary);
          border-radius: var(--radius-md);
          padding: var(--spacing-sm) var(--spacing-md);
          transition: all 0.3s ease;
      }
      
      .form-control:focus, .form-select:focus {
          border-color: var(--accent-color);
          box-shadow: 0 0 0 3px rgba(184, 115, 51, 0.2);
          outline: none;
      }
  
      /* Responsive Design */
      @media (max-width: 1200px) {
          .content-wrapper {
              padding: var(--spacing-md);
          }
      }
      
      @media (max-width: 992px) {
          .content-wrapper {
              padding: var(--spacing-sm);
          }
      }
      
      @media (max-width: 768px) {
          .content-wrapper {
              padding: var(--spacing-md);
              grid-template-columns: repeat(4, 1fr);
          }
      }
      
      @media (max-width: 576px) {
          .content-wrapper {
              padding: var(--spacing-sm);
              grid-template-columns: 1fr;
          }
          
          .btn-primary {
              width: 100%;
              margin-bottom: var(--spacing-sm);
          }
      }
  
      .alert {
          border: none;
          border-radius: var(--radius-lg);
          padding: var(--spacing-sm) var(--spacing-md);
          margin-bottom: var(--spacing-sm);
          display: flex;
          align-items: center;
          justify-content: space-between;
          animation: slideIn 0.3s ease-out;
      }
      
      @keyframes slideIn {
          from {
              transform: translateY(-100%);
              opacity: 0;
          }
          to {
              transform: translateY(0);
              opacity: 1;
          }
      }
      
      .alert-info {
          background-color: var(--alert-info-bg, var(--light-alert-info-bg));
          border-left: 4px solid var(--info, var(--light-info));
      }
      
      .alert-success {
          background-color: var(--alert-success-bg, var(--light-alert-success-bg));
          border-left: 4px solid var(--success, var(--light-success));
      }
      
      .alert-warning {
          background-color: var(--alert-warning-bg, var(--light-alert-warning-bg));
          border-left: 4px solid var(--warning, var(--light-warning));
      }
      
      .alert-danger {
          background-color: var(--alert-error-bg, var(--light-alert-error-bg));
          border-left: 4px solid var(--error, var(--light-error));
      }
      
      .btn-close {
          opacity: 0.5;
          transition: opacity 0.3s ease;
      }
      
      .btn-close:hover {
          opacity: 1;
      }
  
      .notification-link-card {
          border-left: 4px solid var(--primary);
          transition: all 0.2s ease;
      }
      .notification-link-card:hover {
          transform: translateX(5px);
          box-shadow: 0 0.5rem 1rem rgba(0,0,0,0.15);
      }
  
      .row {
          margin-left: calc(-1 * var(--spacing-sm));
          margin-right: calc(-1 * var(--spacing-sm));
      }
      
      .col, [class*="col-"] {
          padding-left: var(--spacing-sm);
          padding-right: var(--spacing-sm);
      }
      
      /* Spacing Utilities Override */
      .p-1 { padding: var(--spacing-xs) !important; }
      .p-2 { padding: var(--spacing-sm) !important; }
      .p-3 { padding: var(--spacing-md) !important; }
      .p-4 { padding: var(--spacing-lg) !important; }
      .p-5 { padding: var(--spacing-xl) !important; }
      
      .m-1 { margin: var(--spacing-xs) !important; }
      .m-2 { margin: var(--spacing-sm) !important; }
      .m-3 { margin: var(--spacing-md) !important; }
      .m-4 { margin: var(--spacing-lg) !important; }
      .m-5 { margin: var(--spacing-xl) !important; }
      
      h1, .h1 { font-size: var(--font-size-3xl); }
      h2, .h2 { font-size: var(--font-size-2xl); }
      h3, .h3 { font-size: var(--font-size-xl); }
      h4, .h4 { font-size: var(--font-size-lg); }
      h5, .h5 { font-size: var(--font-size-base); }
      h6, .h6 { font-size: var(--font-size-sm); }
      
      /* Section Spacing */
      section {
          margin-bottom: var(--spacing-xl);
      }
      
      /* Alert Adjustments */
      .alert {
          padding: var(--spacing-sm) var(--spacing-md);
          margin-bottom: var(--spacing-md);
      }
  </style>
</head>
<body>
    {% block 'Navbar' %}
        {% include "navbar.html" %}
    {% endblock %}

    {% block 'messages' %}
        {% if messages %}
            <div class="content-wrapper">
                {% for message in messages %}
                    <div class="alert alert-info alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    {% endblock %}

    <main class="content-wrapper">
        {% block 'Body' %}{% endblock %}
    </main>

    {% block 'Footer' %}
        {% include "footer.html" %}
    {% endblock %}

    <!-- Essential Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://accounts.google.com/gsi/client" async></script>

    <!-- Theme Management Script -->
    <script>
        // Theme management class
        class ThemeManager {
            constructor() {
                this.html = document.documentElement;
                this.initialize();
            }

            initialize() {
                // Check for saved theme first
                const savedTheme = localStorage.getItem('theme');
                
                if (savedTheme) {
                    // Use saved theme if it exists
                    this.setTheme(savedTheme);
                } else {
                    // Otherwise use system preference
                    this.setThemeBasedOnSystem();
                }

                // Listen for system theme changes
                this.setupSystemThemeListener();
            }

            setThemeBasedOnSystem() {
                if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    this.setTheme('dark');
                } else {
                    this.setTheme('light');
                }
            }

            setupSystemThemeListener() {
                window.matchMedia('(prefers-color-scheme: dark)')
                    .addEventListener('change', e => {
                        // Only change theme if user hasn't set a preference
                        if (!localStorage.getItem('theme')) {
                            this.setTheme(e.matches ? 'dark' : 'light');
                        }
                    });
            }

            setTheme(theme) {
                this.html.setAttribute('data-bs-theme', theme);
                this.updateAllThemeToggles(theme);
            }

            toggleTheme() {
                const currentTheme = this.html.getAttribute('data-bs-theme');
                const newTheme = currentTheme === 'light' ? 'dark' : 'light';
                this.setTheme(newTheme);
                localStorage.setItem('theme', newTheme);
            }

            updateAllThemeToggles(theme) {
                // Update all theme toggle icons on the page
                document.querySelectorAll('.theme-toggle-icon').forEach(icon => {
                    icon.className = `theme-toggle-icon bi ${theme === 'light' ? 'bi-moon-fill' : 'bi-sun-fill'}`;
                });
            }
        }

        // Initialize theme manager
        const themeManager = new ThemeManager();

        // Make themeManager available globally for other templates
        window.themeManager = themeManager;
    </script>
</body>
</html>