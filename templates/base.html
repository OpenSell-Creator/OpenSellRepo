{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="csrf-token" content="{{ csrf_token }}">
    <title>{% block title%}OpenSell{% endblock%}</title>
  
    <!-- CSS Dependencies -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel='stylesheet' href='https://cdn-uicons.flaticon.com/2.5.1/uicons-solid-rounded/css/uicons-solid-rounded.css'>
    <link rel="apple-touch-icon" sizes="180x180" href="images/logoshort.png">
    <link rel="icon" type="image/png" href="{% static 'images/logoshort.png' %}">
    <link rel="shortcut icon" type="image/png" href="{% static 'images/logoshort.png' %}">
    <link rel="apple-touch-icon" href="{% static 'images/logoshort.png' %}">
    <link rel="stylesheet" href="{% static 'css/styles.css'%}">

    <style>
        :root {
            /* Light Theme - Navy Primary with Charcoal Secondary */
            --light-primary-color: #003366;     /* Navy Blue - dominant */
            --light-secondary-color: #004d99;   /* Lighter Navy */
            --light-accent-color: #ff6600;      /* Vibrant Orange accent */
            --light-background: #f5f5f5;        /* Off-white */
            --light-card-background: #ffffff;    /* Pure white */
            --light-text-primary: #003366;      /* Navy text */
            --light-text-secondary: #666666;    /* Light Gray text */
            --light-border-color: #cccccc;      /* Light Gray border */
            --light-hover-bg: #e6e6e6;          /* Light Gray hover */
            --light-success: #28a745;           /* Keep standard success */
            --light-warning: #ff6600;           /* Orange warning */
            --light-error: #dc3545;             /* Keep standard error */
            --light-info: #004d99;              /* Lighter Navy info */
            --light-muted: #8c8c8c;             /* Muted Gray */
            --light-shadow: rgba(0, 51, 102, 0.15);
            
            /* Dark Theme - Charcoal Primary with Navy Accents */
            --dark-primary-color: #003366;      /* Lighter Navy Blue for better contrast */
            --dark-secondary-color: #1a2a3a;    /* Slightly darker Navy */
            --dark-accent-color: #ff6600;       /* Vibrant Orange (unchanged) */
            --dark-background: #121212;         /* Very dark background */
            --dark-card-background: #1e1e1e;    /* Dark surface for cards */
            --dark-text-primary: #ffffff;       /* White text */
            --dark-text-secondary: #d4d4d4;     /* Light Gray text */
            --dark-border-color: #3a3a3a;       /* Medium Gray border */
            --dark-hover-bg: #2a2a2a;           /* Dark hover background */
            --dark-success: #28a745;            /* Green success (unchanged) */
            --dark-warning: #ff6600;            /* Vibrant Orange warning (unchanged) */
            --dark-error: #dc3545;              /* Red error (unchanged) */
            --dark-info: #004d99;               /* Deep Navy info (unchanged) */
            --dark-muted: #6c757d;              /* Muted Gray */
            --dark-shadow: rgba(0, 0, 0, 0.5);  /* Dark shadow */
            
            /* Keep existing Typography variables */
            --font-primary: 'Poppins', sans-serif;
            --font-secondary: 'Newsreader', serif;
            --font-size-xs: 0.7rem;
            --font-size-sm: 0.8rem;
            --font-size-base: 0.95rem;
            --font-size-lg: 1.05rem;
            --font-size-xl: 1.15rem;
            --font-size-2xl: 1.35rem;
            --font-size-3xl: 1.65rem;
        
            /* Keep existing Spacing and Border Radius variables */
            --spacing-xs: 0.15rem;
            --spacing-sm: 0.35rem;
            --spacing-md: 0.75rem;
            --spacing-lg: 1.25rem;
            --spacing-xl: 1.75rem;
            --spacing-2xl: 2.5rem;
            
            --radius-sm: 0.25rem;
            --radius-md: 0.5rem;
            --radius-lg: 1rem;
            --radius-xl: 1.5rem;
            --radius-full: 9999px;
        }
        
        /* Theme Application */
        [data-bs-theme="light"] {
            --primary-color: var(--light-primary-color);
            --secondary-color: var(--light-secondary-color);
            --accent-color: var(--light-accent-color);
            --background-color: var(--light-background);
            --card-background: var(--light-card-background);
            --text-primary: var(--light-text-primary);
            --text-secondary: var(--light-text-secondary);
            --border-color: var(--light-border-color);
            --hover-bg: var(--light-hover-bg);
            --shadow-color: var(--light-shadow);
            --success: var(--light-success);
            --warning: var(--light-warning);
            --error: var(--light-error);
            --info: var(--light-info);
            --muted: var(--light-muted);
        }
        
        [data-bs-theme="dark"] {
            --primary-color: var(--dark-primary-color);
            --secondary-color: var(--dark-secondary-color);
            --accent-color: var(--dark-accent-color);
            --background-color: var(--dark-background);
            --card-background: var(--dark-card-background);
            --text-primary: var(--dark-text-primary);
            --text-secondary: var(--dark-text-secondary);
            --border-color: var(--dark-border-color);
            --hover-bg: var(--dark-hover-bg);
            --shadow-color: var(--dark-shadow);
            --success: var(--dark-success);
            --warning: var(--dark-warning);
            --error: var(--dark-error);
            --info: var(--dark-info);
            --muted: var(--dark-muted);
        }

        :root {
            --svg_pattern_color: 444444; /* For light mode */
        }
        
        [data-bs-theme="dark"] {
            --svg_pattern_color: aaaaaa; /* For dark mode */
        }

        [data-bs-theme="dark"] .btn-outline-primary {
            color: var(--dark-text-primary); 
            border-color: var(--dark-text-primary);
        }
        
        [data-bs-theme="dark"] .btn-outline-primary:hover {
            background-color: var(--dark-text-primary); 
            color: var(--dark-primary-color); 
            border-color: var(--dark-text-primary); 
        }
        
        /* Enhanced Base Styles */
        body {
            font-family: var(--font-primary);
            background-color: var(--background-color);
            color: var(--text-primary);
            line-height: 1.6;
            transition: background-color 0.3s ease, color 0.3s ease;
            padding-top: max(var(--safe-area-inset-top), var(--navbar-height-mobile));
            --viewport-height: 100vh;
            --content-height: calc(var(--viewport-height) - var(--navbar-height-mobile) - var(--bottom-nav-height));
        }
        
        /* Content Wrapper with Advanced Layout */
        .content-wrapper {
            max-width: 1400px;
            margin: 0 auto;
            padding: var(--spacing-lg);
            grid-template-columns: repeat(12, 1fr);
            gap: var(--spacing-md);
        }
        
        .container {
            padding-left: var(--spacing-sm);
            padding-right: var(--spacing-sm);
        }
        
        .row {
            margin-left: calc(-1 * var(--spacing-sm));
            margin-right: calc(-1 * var(--spacing-sm));
        }
        
        .col, [class*="col-"] {
            padding-left: var(--spacing-sm);
            padding-right: var(--spacing-sm);
        }
        
        .card {
            background-color: var(--card-background);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            box-shadow: 0 4px 20px var(--shadow-color);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            overflow: hidden;
            margin-bottom: var(--spacing-md);
        }
        
        .card-title {
            font-size: var(--font-size-lg);
            margin-bottom: var(--spacing-sm);
            color: var(--dark-text-primary); /* White text */
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px var(--shadow-color);
        }
        
        /* Base Button Styles */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            height: 40px; 
            padding: 0 16px;
            font-size: var(--font-size-base);
            font-weight: 500;
            border-radius: var(--radius-md); 
            border: 2px solid transparent; 
            transition: all 0.3s ease; 
            white-space: nowrap; 
            text-align: center;
            cursor: pointer;
        }
        
        /* Primary Button */
        .btn-primary {
            background-color: var(--primary-color);
            color: var(--card-background);
            border-color: var(--primary-color);
        }
        
        .btn-primary:hover {
            background-color: var(--secondary-color);
            border-color: var(--secondary-color);
            transform: translateY(-1px);
        }
        
        /* Secondary Button */
        .btn-secondary {
            background-color: var(--secondary-color);
            color: var(--card-background);
            border-color: var(--secondary-color);
        }
        
        .btn-secondary:hover {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            transform: translateY(-1px);
        }
        
        
        /* Outline Button */
        .btn-outline {
            background-color: transparent;
            color: var(--primary-color);
            border-color: var(--primary-color);
        }
        
        .btn-outline:hover {
            background-color: var(--primary-color);
            color: var(--dark-text-primary); /* White text on hover */
        }

        .btn-outline-primary {
            background-color: transparent;
            color: var(--primary-color);
            border-color: var(--primary-color);
        }
        
        .btn-outline-primary:hover {
            background-color: var(--primary-color); 
            color: var(--card-background); /* Use card background color for text on hover */
            border-color: var(--primary-color); /* Keep border color consistent */
        }
        
        /* Danger Button */
        .btn-danger {
            background-color: var(--error);
            border-color: var(--error);
        }
        
        .btn-danger:hover {
            background-color: var(--dark-error);
            border-color: var(--dark-error);
        }
        
        /* Success Button */
        .btn-success {
            background-color: var(--success);
            border-color: var(--success);
        }
        
        .btn-success:hover {
            background-color: var(--dark-success);
            border-color: var(--dark-success);
        }
        
        /* Warning Button */
        .btn-warning {
            background-color: var(--warning);
            border-color: var(--warning);
        }
        
        .btn-warning:hover {
            background-color: var(--dark-warning);
            border-color: var(--dark-warning);
        }
        
        /* Accent Button */
        .btn-accent {
            background-color: var(--accent-color);
            color: var(--dark-text-primary); /* White text */
            border: none;
        }
        
        .btn-accent:hover {
            background-color: #e65c00; /* Slightly darker orange */
            color: var(--dark-text-primary); /* White text */
        }
        
        /* Custom Card Styles */
        .card-highlight {
            border-left: 4px solid var(--accent-color);
        }

        /* Add these CSS rules to your style section */

        /* Improved dark mode button styling */
        [data-bs-theme="dark"] .btn-primary {
            background-color: var(--dark-primary-color);
            color: var(--dark-text-primary);
            border-color: var(--dark-primary-color);
        }

        [data-bs-theme="dark"] .btn-primary:hover {
            background-color: var(--dark-secondary-color);
            border-color: var(--dark-secondary-color);
        }

        [data-bs-theme="dark"] .btn-secondary {
            background-color: var(--dark-secondary-color);
            color: var(--dark-text-primary);
            border-color: var(--dark-secondary-color);
        }

        [data-bs-theme="dark"] .btn-secondary:hover {
            background-color: var(--dark-primary-color);
            border-color: var(--dark-primary-color);
        }

        /* Fix icons in dark mode */
        [data-bs-theme="dark"] .btn i,
        [data-bs-theme="dark"] .btn .bi,
        [data-bs-theme="dark"] .btn .bx,
        [data-bs-theme="dark"] .btn .material-symbols-outlined {
            color: var(--dark-text-primary);
        }

        /* Improved alert styling for dark mode */
        [data-bs-theme="dark"] .alert {
            background-color: var(--dark-card-background);
            color: var(--dark-text-primary);
        }

        [data-bs-theme="dark"] .alert-info {
            border-left: 4px solid var(--info, var(--dark-info));
        }

        [data-bs-theme="dark"] .alert-success {
            border-left: 4px solid var(--success, var(--dark-success));
        }

        [data-bs-theme="dark"] .alert-warning {
            border-left: 4px solid var(--warning, var(--dark-warning));
        }

        [data-bs-theme="dark"] .alert-danger {
            border-left: 4px solid var(--error, var(--dark-error));
        }

        [data-bs-theme="dark"] .btn-close {
            filter: invert(1); /* This helps the close button be visible in dark mode */
        }
            
    /* Custom Navigation Styles */
    .nav-link.active {
        color: var(--light-accent-color) !important;
        border-bottom: 2px solid var(--light-accent-color);
    }
      
      /* Advanced Form Controls */
      .form-control, .form-select {
          background-color: var(--card-background);
          border: 2px solid var(--border-color);
          color: var(--text-primary);
          border-radius: var(--radius-md);
          padding: var(--spacing-sm) var(--spacing-md);
          transition: all 0.3s ease;
      }
      
      .form-control:focus, .form-select:focus {
          border-color: var(--accent-color);
          box-shadow: 0 0 0 3px rgba(184, 115, 51, 0.2);
          outline: none;
      }
  
      /* Responsive Design */
      @media (max-width: 1200px) {
          .content-wrapper {
              padding: var(--spacing-md);
          }
      }
      
      @media (max-width: 992px) {
          .content-wrapper {
              padding: var(--spacing-sm);
          }
      }
      
      @media (max-width: 768px) {
          .content-wrapper {
              padding: var(--spacing-md);
              grid-template-columns: repeat(4, 1fr);
          }
      }
      
      @media (max-width: 576px) {
          .content-wrapper {
              padding: var(--spacing-sm);
              grid-template-columns: 1fr;
          }
          
          .btn-primary {
              width: 100%;
              margin-bottom: var(--spacing-sm);
          }
      }
  
      /* Simplified Alert Messages Styling */
    .message-container {
        position: relative;
        width: 100%;
        z-index: 1050;
        padding-top: 10px;
        padding-bottom: 5px;
    }
    
    .alert {
        margin: 0 auto 10px;
        max-width: 800px;
        border-radius: var(--radius-md);
        padding: 12px 15px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        box-shadow: 0 2px 5px var(--shadow-color);
        animation: alertFadeIn 0.3s ease forwards;
    }
    
    .alert-info {
        background-color: rgba(0, 77, 153, 0.1);
        border-left: 3px solid var(--info);
        color: var(--text-primary);
    }
    
    .alert-success {
        background-color: rgba(40, 167, 69, 0.1);
        border-left: 3px solid var(--success);
        color: var(--text-primary);
    }
    
    .alert-warning {
        background-color: rgba(255, 102, 0, 0.1);
        border-left: 3px solid var(--warning);
        color: var(--text-primary);
    }
    
    .alert-danger {
        background-color: rgba(220, 53, 69, 0.1);
        border-left: 3px solid var(--error);
        color: var(--text-primary);
    }
    
    .btn-close {
        background: transparent;
        border: none;
        opacity: 0.5;
        transition: opacity 0.2s ease;
        padding: 0;
        margin-left: 10px;
    }
    
    .btn-close:hover {
        opacity: 0.9;
    }
    
    /* Dark mode adjustments */
    [data-bs-theme="dark"] .alert {
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.25);
    }
    
    [data-bs-theme="dark"] .alert-info {
        background-color: rgba(0, 77, 153, 0.2);
    }
    
    [data-bs-theme="dark"] .alert-success {
        background-color: rgba(40, 167, 69, 0.2);
    }
    
    [data-bs-theme="dark"] .alert-warning {
        background-color: rgba(255, 102, 0, 0.2);
    }
    
    [data-bs-theme="dark"] .alert-danger {
        background-color: rgba(220, 53, 69, 0.2);
    }
    
    [data-bs-theme="dark"] .btn-close {
        filter: invert(1);
    }
    
    @keyframes alertFadeIn {
        from {
            opacity: 0;
            transform: translateY(-10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    @keyframes alertFadeOut {
        from {
            opacity: 1;
            transform: translateY(0);
        }
        to {
            opacity: 0;
            transform: translateY(-10px);
        }
    }
    
    .alert.fade-out {
        animation: alertFadeOut 0.3s ease forwards;
    }
      
      .btn-close {
          opacity: 0.5;
          transition: opacity 0.3s ease;
      }
      
      .btn-close:hover {
          opacity: 1;
      }
  
      .notification-link-card {
          border-left: 4px solid var(--primary);
          transition: all 0.2s ease;
      }
      .notification-link-card:hover {
          transform: translateX(5px);
          box-shadow: 0 0.5rem 1rem rgba(0,0,0,0.15);
      }
  
      .row {
          margin-left: calc(-1 * var(--spacing-sm));
          margin-right: calc(-1 * var(--spacing-sm));
      }
      
      .col, [class*="col-"] {
          padding-left: var(--spacing-sm);
          padding-right: var(--spacing-sm);
      }
      
      /* Spacing Utilities Override */
      .p-1 { padding: var(--spacing-xs) !important; }
      .p-2 { padding: var(--spacing-sm) !important; }
      .p-3 { padding: var(--spacing-md) !important; }
      .p-4 { padding: var(--spacing-lg) !important; }
      .p-5 { padding: var(--spacing-xl) !important; }
      
      .m-1 { margin: var(--spacing-xs) !important; }
      .m-2 { margin: var(--spacing-sm) !important; }
      .m-3 { margin: var(--spacing-md) !important; }
      .m-4 { margin: var(--spacing-lg) !important; }
      .m-5 { margin: var(--spacing-xl) !important; }
      
      h1, .h1 { font-size: var(--font-size-3xl); }
      h2, .h2 { font-size: var(--font-size-2xl); }
      h3, .h3 { font-size: var(--font-size-xl); }
      h4, .h4 { font-size: var(--font-size-lg); }
      h5, .h5 { font-size: var(--font-size-base); }
      h6, .h6 { font-size: var(--font-size-sm); }
      
      /* Section Spacing */
      section {
          margin-bottom: var(--spacing-xl);
      }
      
      /* Alert Adjustments */
      .alert {
          padding: var(--spacing-sm) var(--spacing-md);
          margin-bottom: var(--spacing-md);
      }

        /* Add this to your keyframes section */
        @keyframes fadeOut {
            from {
                opacity: 1;
            }
            to {
                opacity: 0;
            }
        }

        .alert.fade-out {
            animation: fadeOut 0.5s ease-out forwards;
        }

        /* Fix for the close button in the sidebar */
        .btn-close-white {
        filter: invert(1) grayscale(100%) brightness(200%);
        }

        /* Ensure the close button is visible and properly positioned */
        .offcanvas-header .btn-close {
        color: white;
        opacity: 0.8;
        padding: 0.5rem;
        }

        .offcanvas-header .btn-close:hover {
        opacity: 1;
        }
  </style>
</head>
<body>
    {% block 'Navbar' %}
        {% include "navbar.html" %}
    {% endblock %}

    {% block 'messages' %}
    {% if messages %}
        <div class="message-container">
            {% for message in messages %}
                <div class="alert {% if message.tags %}alert-{{ message.tags }}{% else %}alert-info{% endif %}" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" aria-label="Close"></button>
                </div>
            {% endfor %}
        </div>
    {% endif %}
    {% endblock %}

    <div class="content-wrapper">
        <div class="container-fluid py-2">
        {% block 'Body' %}{% endblock %}
        </div>
    </div>

    {% block 'Footer' %}
        {% include "footer.html" %}
    {% endblock %}

    <!-- Essential Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://accounts.google.com/gsi/client" async></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Add scroll handling JavaScript here
            if (window.innerWidth < 992) {
                let lastScroll = 0;
                
                window.addEventListener('scroll', () => {
                    const currentScroll = window.scrollY;
                    
                    if (currentScroll > lastScroll && currentScroll > 100) {
                        document.getElementById('mainNavbar').style.transform = 'translateY(-100%)';
                        document.getElementById('bottomNav').style.transform = 'translateY(100%)';
                    } else {
                        document.getElementById('mainNavbar').style.transform = 'translateY(0)';
                        document.getElementById('bottomNav').style.transform = 'translateY(0)';
                    }
                    
                    lastScroll = currentScroll;
                });
            }
        });
    </script>
    <!-- Theme Management Script -->
    <script>
   
        // Theme management class
        class ThemeManager {
            constructor() {
                this.html = document.documentElement;
                this.initialize();
            }

            initialize() {
                // Check for saved theme first
                const savedTheme = localStorage.getItem('theme');
                
                if (savedTheme) {
                    // Use saved theme if it exists
                    this.setTheme(savedTheme);
                } else {
                    // Otherwise use system preference
                    this.setThemeBasedOnSystem();
                }

                // Listen for system theme changes
                this.setupSystemThemeListener();
            }

            setThemeBasedOnSystem() {
                if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    this.setTheme('dark');
                } else {
                    this.setTheme('light');
                }
            }

            setupSystemThemeListener() {
                window.matchMedia('(prefers-color-scheme: dark)')
                    .addEventListener('change', e => {
                        // Only change theme if user hasn't set a preference
                        if (!localStorage.getItem('theme')) {
                            this.setTheme(e.matches ? 'dark' : 'light');
                        }
                    });
            }

            setTheme(theme) {
                this.html.setAttribute('data-bs-theme', theme);
                this.updateAllThemeToggles(theme);
            }

            toggleTheme() {
                const currentTheme = this.html.getAttribute('data-bs-theme');
                const newTheme = currentTheme === 'light' ? 'dark' : 'light';
                this.setTheme(newTheme);
                localStorage.setItem('theme', newTheme);
            }

            updateAllThemeToggles(theme) {
                // Update all theme toggle icons on the page
                document.querySelectorAll('.theme-toggle-icon').forEach(icon => {
                    icon.className = `theme-toggle-icon bi ${theme === 'light' ? 'bi-moon-fill' : 'bi-sun-fill'}`;
                });
            }
        }

        // Initialize theme manager
        const themeManager = new ThemeManager();
        // Make themeManager available globally for other templates
        window.themeManager = themeManager;

        // Set up simple alert handling
        const alerts = document.querySelectorAll('.alert');
        
        alerts.forEach(alert => {
            // Set up close button event
            const closeBtn = alert.querySelector('.btn-close');
            if (closeBtn) {
                closeBtn.addEventListener('click', function() {
                    dismissAlert(alert);
                });
            }
            
            // Auto dismiss after 2 seconds
            setTimeout(() => {
                dismissAlert(alert);
            }, 2000);
        });
        
        function dismissAlert(alert) {
            if (!alert.classList.contains('fade-out')) {
                alert.classList.add('fade-out');
                setTimeout(() => {
                    alert.remove();
                }, 300);
            }
        }

        // Add to the DOMContentLoaded event listener
        document.addEventListener('DOMContentLoaded', function() {
            setupModernAlerts();
        });
    </script>
</body>
</html>